(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[830],{830:(e,t,s)=>{"use strict";s.r(t),s.d(t,{UsersModule:()=>J});var i=s(3679),r=s(3142),n=s(8583),o=s(3981),a=s(8532),u=s(4883),l=s(7716),c=s(6518),d=s(9133),m=s(380),p=s(8295),f=s(9983),h=s(1095);function g(e,t){if(1&e&&(l.TgZ(0,"p"),l._uU(1),l.qZA()),2&e){const e=l.oxw();l.xp6(1),l.hij("Cliente: ",e.client.name,"")}}function Z(e,t){1&e&&(l.TgZ(0,"div"),l._uU(1," Las contrase\xf1as no son iguales "),l.qZA())}let v=(()=>{class e{constructor(e,t,s,r){this.authService=e,this.fb=t,this.swal=s,this.clientService=r,this.user=null,this.client=null,this.formPass=this.fb.group({password:["",[i.kI.required]],passwordRepeat:["",[i.kI.required]]},{validators:[o.B]})}ngOnInit(){this.user=this.authService.user,this.user&&this.user.role===u.u.CLIENT&&this.clientService.findOneByUserId(this.user.id).subscribe(e=>{e&&e.client&&(this.client=e.client)})}save(){var e;this.formPass.valid&&this.user&&this.user.id&&this.authService.changePass(this.user.id,null===(e=this.formPass.get("password"))||void 0===e?void 0:e.value).subscribe(()=>{this.swal.fire({confirmButtonText:"Ok!",icon:a.Y.SUCCESS,text:"La contrase\xf1a se cambi\xf3 con \xe9xito",title:""})})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.e),l.Y36(i.qu),l.Y36(d.T),l.Y36(m.y))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-users-profile"]],decls:27,vars:7,consts:[[1,"d-flex","flex-row","flex-wrap","justify-content-center"],[4,"ngIf"],[1,"d-flex","flex-column","gap-2",3,"formGroup","ngSubmit"],["type","password","matInput","","autocomplete","","formControlName","password"],["type","password","matInput","","autocomplete","","formControlName","passwordRepeat"],["type","submit","mat-raised-button","","color","primary",1,"mt-3",3,"disabled"]],template:function(e,t){1&e&&(l.TgZ(0,"div",0),l.TgZ(1,"div"),l.TgZ(2,"h1"),l._uU(3),l.qZA(),l._UZ(4,"hr"),l.TgZ(5,"p"),l._uU(6),l.qZA(),l.TgZ(7,"p"),l._uU(8),l.qZA(),l.YNc(9,g,2,1,"p",1),l.TgZ(10,"div"),l.TgZ(11,"div"),l.TgZ(12,"form",2),l.NdJ("ngSubmit",function(){return t.save()}),l.TgZ(13,"mat-form-field"),l.TgZ(14,"mat-label"),l._uU(15,"Contrase\xf1a"),l.qZA(),l._UZ(16,"input",3),l.TgZ(17,"mat-error"),l._uU(18,"La contrase\xf1a es requerida"),l.qZA(),l.qZA(),l.TgZ(19,"mat-form-field"),l.TgZ(20,"mat-label"),l._uU(21,"Repetir contrase\xf1a"),l.qZA(),l._UZ(22,"input",4),l._UZ(23,"mat-error"),l.qZA(),l.YNc(24,Z,2,0,"div",1),l.TgZ(25,"button",5),l._uU(26," Guardar "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(3),l.hij("Usuario: ",null==t.user?null:t.user.username,""),l.xp6(3),l.hij("Correo: ",null==t.user?null:t.user.email,""),l.xp6(2),l.hij("Rol: ",null==t.user?null:t.user.role,""),l.xp6(1),l.Q6J("ngIf",t.client),l.xp6(3),l.Q6J("formGroup",t.formPass),l.xp6(12),l.Q6J("ngIf",(null==t.formPass.errors?null:t.formPass.errors.notEquals)&&t.formPass.touched),l.xp6(1),l.Q6J("disabled",t.formPass.invalid))},directives:[n.O5,i._Y,i.JL,i.sg,p.KE,p.hX,f.Nt,i.Fj,i.JJ,i.u,p.TO,h.lW],encapsulation:2}),e})();var A=s(2238),T=s(41),q=s(7441),b=s(2458);let x=(()=>{class e{constructor(e,t,s,i){this.data=e,this.matDialogRef=t,this.userService=s,this.swal=i}ngOnInit(){this.role=this.data.role}save(){this.userService.changeRole(this.data.id,this.role).subscribe(e=>{this.swal.fire({confirmButtonText:"Ok!",icon:a.Y.SUCCESS,text:"El Rol se modific\xf3 con \xe9xito",title:""}),this.data.role=this.role,this.matDialogRef.close(this.data)})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(A.WI),l.Y36(A.so),l.Y36(T.K),l.Y36(d.T))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-user-role-dialog"]],decls:14,vars:1,consts:[["appearance","fill"],[3,"ngModel","ngModelChange"],["value","none"],["value","client"],["value","doctor"],["value","admin"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,t){1&e&&(l.TgZ(0,"mat-form-field",0),l.TgZ(1,"mat-label"),l._uU(2,"Seleccione un rol"),l.qZA(),l.TgZ(3,"mat-select",1),l.NdJ("ngModelChange",function(e){return t.role=e}),l.TgZ(4,"mat-option",2),l._uU(5,"Anonimo"),l.qZA(),l.TgZ(6,"mat-option",3),l._uU(7,"Cliente"),l.qZA(),l.TgZ(8,"mat-option",4),l._uU(9,"Doctor"),l.qZA(),l.TgZ(10,"mat-option",5),l._uU(11,"Administrador"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(12,"button",6),l.NdJ("click",function(){return t.save()}),l._uU(13,"Guardar"),l.qZA()),2&e&&(l.xp6(3),l.Q6J("ngModel",t.role))},directives:[p.KE,p.hX,q.gD,i.JJ,i.On,b.ey,h.lW],encapsulation:2}),e})();function w(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",4),l.TgZ(1,"div",5),l.TgZ(2,"button",6),l.NdJ("click",function(){const t=l.CHM(e).$implicit;return l.oxw().activateOrDeactivate(t)}),l._uU(3),l.qZA(),l.TgZ(4,"button",7),l.NdJ("click",function(){const t=l.CHM(e).$implicit;return l.oxw().changeRole(t)}),l._uU(5," Rol "),l.qZA(),l.qZA(),l.TgZ(6,"pre",8),l._uU(7),l.ALo(8,"json"),l.qZA(),l.qZA()}if(2&e){const e=t.$implicit;l.xp6(2),l.Q6J("color",e.isActive?"warn":"primary"),l.xp6(1),l.hij(" ",e.isActive?"Baja":"Alta"," "),l.xp6(3),l.Q6J("ngClass",e.isActive?"bg-dark":"bg-danger"),l.xp6(1),l.Oqu(l.lcZ(8,4,e))}}let _=(()=>{class e{constructor(e,t,s){this.userService=e,this.matDialog=t,this.swal=s,this.users=[],this.usersSource=[],this.term=""}ngOnInit(){this.userService.findAll().subscribe(e=>{e&&e.users&&(this.usersSource=e.users,this.users=this.usersSource)})}filter(){this.users=this.usersSource.filter(e=>Object.values(e).join("").trim().toLowerCase().includes(this.term.trim().toLowerCase()))}activateOrDeactivate(e){e&&this.userService.removeOrActivate(e.id,!e.isActive).subscribe(()=>{let t=this.usersSource.findIndex(t=>t.id===e.id);this.usersSource[t].isActive=!e.isActive,this.filter(),this.swal.fire({confirmButtonText:"Ok!",icon:a.Y.SUCCESS,text:e.isActive?"El usuario se di\xf3 de alta correctamente":"El usuario se di\xf3 de baja correctamente",title:""})})}changeRole(e){this.matDialog.open(x,{data:e}).afterClosed().subscribe(e=>{if(e&&e.id){let t=this.usersSource.findIndex(t=>t.id===e.id);this.usersSource[t]=e,t=this.users.findIndex(t=>t.id===e.id),this.users[t]=e}})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(T.K),l.Y36(A.uw),l.Y36(d.T))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-users-list"]],decls:9,vars:2,consts:[[1,"w-100"],["matInput","","type","text",3,"ngModel","ngModelChange","keyup"],[1,"row"],["class","col-sm-12 col-md-6 col-lg-4 animate__animated animate__fadeIn",4,"ngFor","ngForOf"],[1,"col-sm-12","col-md-6","col-lg-4","animate__animated","animate__fadeIn"],[1,"d-flex","gap-2"],["mat-raised-button","",1,"mb-1","flex-grow-1",3,"color","click"],["mat-raised-button","","color","basic",1,"mb-1","flex-grow-1",3,"click"],[1,"text-white","p-3","rounded",3,"ngClass"]],template:function(e,t){1&e&&(l.TgZ(0,"h1"),l._uU(1,"Usuarios"),l.qZA(),l._UZ(2,"hr"),l.TgZ(3,"mat-form-field",0),l.TgZ(4,"mat-label"),l._uU(5,"Filtrar"),l.qZA(),l.TgZ(6,"input",1),l.NdJ("ngModelChange",function(e){return t.term=e})("keyup",function(){return t.filter()}),l.qZA(),l.qZA(),l.TgZ(7,"div",2),l.YNc(8,w,9,6,"div",3),l.qZA()),2&e&&(l.xp6(6),l.Q6J("ngModel",t.term),l.xp6(2),l.Q6J("ngForOf",t.users))},directives:[p.KE,p.hX,f.Nt,i.Fj,i.JJ,i.On,n.sg,h.lW,n.mk],pipes:[n.Ts],encapsulation:2}),e})();var U=s(4655);const S=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-users-home"]],decls:2,vars:0,consts:[[1,"container","mt-3"]],template:function(e,t){1&e&&(l.TgZ(0,"div",0),l._UZ(1,"router-outlet"),l.qZA())},directives:[U.lC],encapsulation:2}),e})(),children:[{path:"list",component:_},{path:"profile",component:v},{path:"**",redirectTo:"list"}]}];let C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[U.Bz.forChild(S)],U.Bz]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[n.ez,C,r.q,i.u5,i.UX]]}),e})()}}]);